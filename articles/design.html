<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Package design and process • ripeds</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Package design and process">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ripeds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Get started"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Vignettes</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nehgov/ripeds/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Package design and process</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nehgov/ripeds/blob/main/vignettes/design.Rmd" class="external-link"><code>vignettes/design.Rmd</code></a></small>
      <div class="d-none name"><code>design.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="ipeds-structure">IPEDS structure<a class="anchor" aria-label="anchor" href="#ipeds-structure"></a>
</h2>
<p>IPEDS does not have a true API for accessing its data files. For
users who want complete data files, there are two primary download
options:</p>
<ol style="list-style-type: decimal">
<li><a href="https://nces.ed.gov/ipeds/use-the-data/download-access-database" class="external-link">Microsoft
Access data bases</a></li>
<li><a href="https://nces.ed.gov/ipeds/datacenter/DataFiles.aspx" class="external-link">Complete data
files</a></li>
</ol>
<p>Each version has benefits and drawbacks. Whereas Access databases
helpfully provide all data tables for a given year, the files are large
and in a special database format. Access databases also only go back to
the 2004-2005 academic year data collection.</p>
<p>On the other hand, the complete data files are smaller — effectively
zipped CSV versions of the database tables. They also include all
available data, which in some cases goes back to 1980. However, it can
be difficult to know which files contain variables of interest without
downloading multiple dictionary files. And once the correct files are
identified, there are potentially many files to download.</p>
<p><code>ripeds</code> simulates an API by smartly downloading, reading,
and wrangling complete data files. For users who already have the
complete data files they need on their computer, <code>ripeds</code> can
instead use those files, saving bandwidth and the time necessary to
download.</p>
<p>Using complete data files rather than Access databases allows for
complete coverage of IPEDS data and doesn’t require users to install
extra external database tools. To aid users not already familiar with
the structure of IPEDS, <code>ripeds</code> also provides a searchable
data dictionary that can be used to find and request variables of
interest.</p>
</div>
<div class="section level2">
<h2 id="design-principles">Design principles<a class="anchor" aria-label="anchor" href="#design-principles"></a>
</h2>
<p><code>ripeds</code> is built with the following design principles, in
general order of importance:</p>
<ol style="list-style-type: decimal">
<li>Support users who don’t already know IPEDS structure</li>
<li>Allow the user maximum flexibility in terms of variables selected,
filters, and how output is returned</li>
<li>Try to give the user what they request and, if not possible, give an
informative error</li>
<li>Be as memory and bandwidth efficient as possible</li>
</ol>
<p>In some instances, these design principles are at odds with each
other. Allowing users more flexibility in choosing filters means that
there might be instances in which many files need to be downloaded
(breaking 4) or that the request to return unjoined files in a list
cannot also correctly apply the filter (breaking 3). Based on the
complexity of IPEDS, there is unfortunately no way around some
incommensurable requests. Users who understand these design choices,
however, can find ways to mitigate unintended output and ultimately
gather the data they need in the format required for their analysis.</p>
</div>
<div class="section level2">
<h2 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h2>
<p>The general process for returning data from a call is as follows:</p>
<ol style="list-style-type: decimal">
<li>Using an internal data dictionary, generate a list of complete data
files that contain selected variables alongside chosen years</li>
<li>Read complete data files into memory — downloading if necessary —
selecting variables as requested</li>
<li>Return output: list of each individual file used, list of files in
which like files across years have been binded, or single joined data
frame</li>
</ol>
<p>As an example, take the following call:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ipeds_init.html">ipeds_init</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_select.html">ipeds_select</a></span><span class="op">(</span><span class="va">instnm</span>, <span class="va">stabbr</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_year.html">ipeds_year</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_get.html">ipeds_get</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This call would generate the following work flow:</p>
<ol style="list-style-type: decimal">
<li>Filter potential data files to those released for 2023, and check
data dictionary for <code>instnm</code> and <code>stabbr</code>
<ul>
<li><em>both are found in <code>HD2023</code> data file</em></li>
</ul>
</li>
<li>Check <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code> for <code>HD2023.zip</code>. If it’s
not there, download to <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code> since no local directory
to search is given
<ul>
<li><em>HD2023.zip is either found or downloaded to
<code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir()</a></code></em></li>
</ul>
</li>
<li>Read in <code>hd2023.csv</code> (or revised version,
<code>hd2023_rv.csv</code>, if it exists by default), selecting
<code>instnm</code> and <code>stabbr</code> as well as
<code>unitid</code>
</li>
<li>Return data frame</li>
</ol>
<div class="section level3">
<h3 id="using-a-filter">Using a filter<a class="anchor" aria-label="anchor" href="#using-a-filter"></a>
</h3>
<p>With a filter, the process becomes a little more complex. Because
filtering variables might be located in different data files, these data
files must first be read into memory and combined as necessary so that
the filter can be applied.</p>
<p>As an added wrinkle, while most complete data files are in a wide
format, with each table row representing a unique institution (by
UNITID), some are in long format, in which each institution can have
multiple rows in the table.</p>
<p>For more detailed information on how filters work with
<code>ripeds</code>, see the <a href="./filter_behavior.html">vignette
on filtering behavior</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="return">Return<a class="anchor" aria-label="anchor" href="#return"></a>
</h2>
<p>By default, <code>ripeds</code> will attempt to combine all files
into a single data.frame. This is a two step process:</p>
<ol style="list-style-type: decimal">
<li>Bind like files, meaning those that contain the same variables, but
in different years. This means files can simply be row appended.</li>
<li>Join different file types by UNITID and year. A full or outer join
is used, so as not to artificially subset the resulting data.frame based
on the order of the joins. This may result in missing values depending
the specific nature of the call.</li>
</ol>
<p>The user can also choose to return files row bound only with like
files, but not joined across files or entirely individually. Both of
these options will result in the return of a list.</p>
<p>If the user chooses only to bind like files, but the result is a
single bound data.frame, output will be a list with one item. For
example,</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ipeds_init.html">ipeds_init</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_select.html">ipeds_select</a></span><span class="op">(</span><span class="va">instnm</span>, <span class="va">stabbr</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_year.html">ipeds_year</a></span><span class="op">(</span><span class="fl">2022</span><span class="op">:</span><span class="fl">2023</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_get.html">ipeds_get</a></span><span class="op">(</span>join <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>returns a list with one item: a data.frame with two observations per
unique UNITID containing the UNITID, institution name, state
abbreviation, year, and file name. Choosing not to bind (which by
default also sets <code>join = FALSE</code>),</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ipeds_init.html">ipeds_init</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_select.html">ipeds_select</a></span><span class="op">(</span><span class="va">instnm</span>, <span class="va">stabbr</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_year.html">ipeds_year</a></span><span class="op">(</span><span class="fl">2022</span><span class="op">:</span><span class="fl">2023</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_get.html">ipeds_get</a></span><span class="op">(</span>bind <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>returns a list of two items: a separate data.frame containing UNITID,
institution name, state abbreviation, file name, and year for each year.
Returning to the original call, choosing either
<code>join = FALSE</code> or <code>bind = FALSE</code>,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ipeds_init.html">ipeds_init</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_select.html">ipeds_select</a></span><span class="op">(</span><span class="va">instnm</span>, <span class="va">stabbr</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_year.html">ipeds_year</a></span><span class="op">(</span><span class="fl">2023</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/ipeds_get.html">ipeds_get</a></span><span class="op">(</span>bind <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>will return a single data.frame in a list. Even though this is the
same data (with the addition of the file name in the data.frame) as was
returned in the first call since all the requested data come from a
single complete data file, <code>ripeds</code> returns a list instead of
a data.frame object for the sake of consistency.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Benjamin Skinner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
